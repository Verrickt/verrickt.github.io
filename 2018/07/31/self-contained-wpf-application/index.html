<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>Build a (partial) self-contained WPF application | Melchior on CLR</title>
  <meta name="description" content="A programmer focus mainly on Microsoft Technologies" />
  <meta name="keywords" content="Windows desktop,C#,XAML,UWP,WPF,OpenSource,GNU/Linux,CLI" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="shortcut icon" href="/">
  <link rel="alternate" href="/atom.xml" title="Melchior on CLR">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="å·¨äººçš„è‚©è†€æ–°äº‹ç‰©çš„äº§ç”Ÿæ€»æ˜¯ä¸è€äº‹ç‰©æœ‰åƒä¸ä¸‡ç¼•çš„è”ç³»ã€‚æˆ–æ˜¯ä»ä¸­å¾—åˆ°å¯å‘ï¼Œæˆ–æ˜¯å¯¹å…¶å…¨é¢æ”¹è‰¯ã€‚æ–°äº‹ç‰©çš„æºå¤´é€šå¸¸å¯ä»¥è¿½æº¯åˆ°å¾ˆä¹…è¿œçš„ä¸€äº›æ¦‚å¿µä¸Šã€‚å› æ­¤æœ‰äº†ã€Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šã€ è¿™æ ·çš„è¯´æ³•ã€‚åœ¨ç¨‹åºè®¾è®¡é‡Œé¢ï¼Œã€Œå·¨äººä»¬çš„è‚©è†€ã€ å°±æ˜¯æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä½¿ç”¨çš„åº“äº†ã€‚è¸©åœ¨è¿™äº›ã€Œå·¨äººã€ä»¬çš„è‚©è†€ä¸Šæˆ‘ä»¬çš„ç¨‹åºæ‰å¾—ä»¥é‡è§å¤©æ—¥ï¼›ä¸ºäº†å®ç°ä¸€ä¸ªåº“ï¼Œæœ‰æ—¶å€™ä¼šä½¿ç”¨åˆ°å…¶ä»–çš„åº“ã€‚æˆ‘ä»¬æ‰€ä¾èµ–çš„ã€Œå·¨äººã€åˆè¸©åœ¨äº†å…¶ä»–ã€Œå·¨äººã€çš„è‚©è†€ä¸Šï¼ŒæŠŠä¾èµ–å…³ç³»å˜æˆäº†æ ‘">
<meta name="keywords" content="WPF,.Net Framework">
<meta property="og:type" content="article">
<meta property="og:title" content="Build a (partial) self-contained WPF application">
<meta property="og:url" content="https://verrickt.github.io/2018/07/31/self-contained-wpf-application/index.html">
<meta property="og:site_name" content="Melchior on CLR">
<meta property="og:description" content="å·¨äººçš„è‚©è†€æ–°äº‹ç‰©çš„äº§ç”Ÿæ€»æ˜¯ä¸è€äº‹ç‰©æœ‰åƒä¸ä¸‡ç¼•çš„è”ç³»ã€‚æˆ–æ˜¯ä»ä¸­å¾—åˆ°å¯å‘ï¼Œæˆ–æ˜¯å¯¹å…¶å…¨é¢æ”¹è‰¯ã€‚æ–°äº‹ç‰©çš„æºå¤´é€šå¸¸å¯ä»¥è¿½æº¯åˆ°å¾ˆä¹…è¿œçš„ä¸€äº›æ¦‚å¿µä¸Šã€‚å› æ­¤æœ‰äº†ã€Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šã€ è¿™æ ·çš„è¯´æ³•ã€‚åœ¨ç¨‹åºè®¾è®¡é‡Œé¢ï¼Œã€Œå·¨äººä»¬çš„è‚©è†€ã€ å°±æ˜¯æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä½¿ç”¨çš„åº“äº†ã€‚è¸©åœ¨è¿™äº›ã€Œå·¨äººã€ä»¬çš„è‚©è†€ä¸Šæˆ‘ä»¬çš„ç¨‹åºæ‰å¾—ä»¥é‡è§å¤©æ—¥ï¼›ä¸ºäº†å®ç°ä¸€ä¸ªåº“ï¼Œæœ‰æ—¶å€™ä¼šä½¿ç”¨åˆ°å…¶ä»–çš„åº“ã€‚æˆ‘ä»¬æ‰€ä¾èµ–çš„ã€Œå·¨äººã€åˆè¸©åœ¨äº†å…¶ä»–ã€Œå·¨äººã€çš„è‚©è†€ä¸Šï¼ŒæŠŠä¾èµ–å…³ç³»å˜æˆäº†æ ‘">
<meta property="og:locale" content="zh-CN,en-US">
<meta property="og:updated_time" content="2018-08-03T03:14:31.174Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Build a (partial) self-contained WPF application">
<meta name="twitter:description" content="å·¨äººçš„è‚©è†€æ–°äº‹ç‰©çš„äº§ç”Ÿæ€»æ˜¯ä¸è€äº‹ç‰©æœ‰åƒä¸ä¸‡ç¼•çš„è”ç³»ã€‚æˆ–æ˜¯ä»ä¸­å¾—åˆ°å¯å‘ï¼Œæˆ–æ˜¯å¯¹å…¶å…¨é¢æ”¹è‰¯ã€‚æ–°äº‹ç‰©çš„æºå¤´é€šå¸¸å¯ä»¥è¿½æº¯åˆ°å¾ˆä¹…è¿œçš„ä¸€äº›æ¦‚å¿µä¸Šã€‚å› æ­¤æœ‰äº†ã€Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šã€ è¿™æ ·çš„è¯´æ³•ã€‚åœ¨ç¨‹åºè®¾è®¡é‡Œé¢ï¼Œã€Œå·¨äººä»¬çš„è‚©è†€ã€ å°±æ˜¯æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä½¿ç”¨çš„åº“äº†ã€‚è¸©åœ¨è¿™äº›ã€Œå·¨äººã€ä»¬çš„è‚©è†€ä¸Šæˆ‘ä»¬çš„ç¨‹åºæ‰å¾—ä»¥é‡è§å¤©æ—¥ï¼›ä¸ºäº†å®ç°ä¸€ä¸ªåº“ï¼Œæœ‰æ—¶å€™ä¼šä½¿ç”¨åˆ°å…¶ä»–çš„åº“ã€‚æˆ‘ä»¬æ‰€ä¾èµ–çš„ã€Œå·¨äººã€åˆè¸©åœ¨äº†å…¶ä»–ã€Œå·¨äººã€çš„è‚©è†€ä¸Šï¼ŒæŠŠä¾èµ–å…³ç³»å˜æˆäº†æ ‘">
    
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href='//cdn.bootcss.com/node-waves/0.7.5/waves.min.css' rel='stylesheet'>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href='/' >
				Melchior on CLR
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/'>
								Home
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/archives'>
								Archives
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/about'>
								About
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search flat-box"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>
		
		<div class='nav-sub container container--flex'>
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				Word of Forks
			</a>

			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class='s-top'><a href='javascript:void(0)'><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<li class='s-toc'><a href='javascript:void(0)'><span class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
			<a href="/" class="nav-home nav">
				Home
			</a>
		
			<a href="/archives" class="nav-archives nav">
				Archives
			</a>
		
			<a href="/about" class="nav-about nav">
				About
			</a>
		
	</nav>
</aside>

    <script>setLoadingBarProgress(40);</script>
  
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        <article id="post-self-contained-wpf-application"
  class="post white-box article-type-post"
  itemscope itemprop="blogPost">
	<section class='meta'>
	<h2 class="title">
  	<a href="/2018/07/31/self-contained-wpf-application/">
    	Build a (partial) self-contained WPF application
    </a>
  </h2>
  <div class="status" >
	  <div class='item-container'>
		<time>
			Published at
			Jul 31, 2018  
		  </time>
	  </div>
	<div class='item-container'>
		<time>
			Last updated
			Aug 3, 2018
		  </time>
	</div>
	<div class='item-container hide-on-mobile'>
		<time>
			1.9k
			words
		  </time>
	</div>
	<div class='item-container hide-on-mobile'>
		<time>
			<time  id='busuanzi_value_page_pv'></time>
view			
		  </time>
	</div>
	
</div>
	</section>
	
		<section class="toc-wrapper"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#å·¨äººçš„è‚©è†€"><span class="toc-number">1.</span> <span class="toc-text">å·¨äººçš„è‚©è†€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Self-contained-in-NET"><span class="toc-number">2.</span> <span class="toc-text">Self-contained in .NET</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#é™æ€é“¾æ¥"><span class="toc-number">2.1.</span> <span class="toc-text">é™æ€é“¾æ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å†…åµŒèµ„æº"><span class="toc-number">2.2.</span> <span class="toc-text">å†…åµŒèµ„æº</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dependencies-of-my-dependencies-is-not-my-dependencies"><span class="toc-number">3.</span> <span class="toc-text">Dependencies of my dependencies, is not my dependencies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ€»ç»“"><span class="toc-number">4.</span> <span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol></section>
	
	<section class="article typo">
  	<div class="article-entry" itemprop="articleBody">
    	<h2 id="å·¨äººçš„è‚©è†€"><a href="#å·¨äººçš„è‚©è†€" class="headerlink" title="å·¨äººçš„è‚©è†€"></a>å·¨äººçš„è‚©è†€</h2><p>æ–°äº‹ç‰©çš„äº§ç”Ÿæ€»æ˜¯ä¸è€äº‹ç‰©æœ‰åƒä¸ä¸‡ç¼•çš„è”ç³»ã€‚æˆ–æ˜¯ä»ä¸­å¾—åˆ°å¯å‘ï¼Œæˆ–æ˜¯å¯¹å…¶å…¨é¢æ”¹è‰¯ã€‚æ–°äº‹ç‰©çš„æºå¤´é€šå¸¸å¯ä»¥è¿½æº¯åˆ°å¾ˆä¹…è¿œçš„ä¸€äº›æ¦‚å¿µä¸Šã€‚å› æ­¤æœ‰äº†ã€Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šã€ è¿™æ ·çš„è¯´æ³•ã€‚åœ¨ç¨‹åºè®¾è®¡é‡Œé¢ï¼Œã€Œå·¨äººä»¬çš„è‚©è†€ã€ å°±æ˜¯æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä½¿ç”¨çš„åº“äº†ã€‚è¸©åœ¨è¿™äº›ã€Œå·¨äººã€ä»¬çš„è‚©è†€ä¸Šæˆ‘ä»¬çš„ç¨‹åºæ‰å¾—ä»¥é‡è§å¤©æ—¥ï¼›ä¸ºäº†å®ç°ä¸€ä¸ªåº“ï¼Œæœ‰æ—¶å€™ä¼šä½¿ç”¨åˆ°å…¶ä»–çš„åº“ã€‚æˆ‘ä»¬æ‰€ä¾èµ–çš„ã€Œå·¨äººã€åˆè¸©åœ¨äº†å…¶ä»–ã€Œå·¨äººã€çš„è‚©è†€ä¸Šï¼ŒæŠŠä¾èµ–å…³ç³»å˜æˆäº†æ ‘çŠ¶ç»“æ„ï¼Œæˆ‘ä»¬çš„ç¨‹åºå¤„åœ¨æ ¹èŠ‚ç‚¹ã€‚</p>
<p>æ‰¯è¿œäº†:)</p>
<a id="more"></a>
<p>å¼€å‘çš„æ—¶å€™æœ‰åŒ…ç®¡ç†å·¥å…·å¸®æˆ‘ä»¬ç®¡ç†ä¾èµ–ï¼Œè€Œåˆ°äº†åˆ†å‘çš„æ—¶å€™ï¼Œéœ€è¦ä¸€ä¸ªå®¹å™¨æŠŠæˆ‘ä»¬çš„ç¨‹åºå’Œå®ƒçš„ä¾èµ–é¡¹ä¸€èµ·åˆ†å‘ã€‚è¿™å°±éœ€è¦ç”¨åˆ°å®‰è£…ç¨‹åºã€‚æœ€ç»ˆç”¨æˆ·åªè¦æ‹¿åˆ°å®‰è£…ç¨‹åºï¼Œè¿è¡Œå®‰è£…ï¼Œç”±å®‰è£…ç¨‹åºå»æ“å¿ƒä¾èµ–é¡¹åˆ°åº•åº”è¯¥æ”¾åœ¨å“ªã€‚</p>
<p>äººæ˜¯æ‡’æƒ°çš„åŠ¨ç‰©ï¼Œä»ç”¨æˆ·å‘ç°è½¯ä»¶åˆ°çœŸæ­£ç”¨ä¸Šè½¯ä»¶ä¹‹é—´ï¼Œæ¯å¤šä¸€ä¸ªæ­¥éª¤éƒ½ä¼šè®©æŸå¤±ä¸€æ‰¹æ½œåœ¨ç”¨æˆ·ã€‚è€Œç°åœ¨éšç€æ‰‹æœºçš„æµè¡Œï¼Œç”¨æˆ·å·²ç»ä¸æƒ³å®‰è£…äº†ã€‚ä»–ä»¬åªæƒ³ä¸‹è½½ã€Œè½¯ä»¶ã€ï¼ŒåŒå‡»å°±èƒ½ç›´æ¥è¿è¡Œã€‚è‡³äºä»€ä¹ˆå®‰è£…è·¯å¾„ï¼ŒUACæƒé™ä¹‹ç±»çš„ç”¨æˆ·æ‰ä¸æƒ³æ“å¿ƒå‘¢ã€‚</p>
<p>è¿™å°±è¦æ±‚æˆ‘ä»¬çš„ç¨‹åºè¦å°†å®‰è£…è¿™ä¸ªè¿‡ç¨‹éšè—èµ·æ¥ã€‚åœ¨ç”¨æˆ·çœ‹ä¸åˆ°çš„æƒ…å†µä¸‹éƒ¨ç½²è‡ªå·±çš„ä¾èµ–é¡¹ã€‚è¿™æ ·çš„ç¨‹åºåœ¨è‹±æ–‡é‡Œè¢«ç§°ä¸º self-contained</p>
<blockquote>
<p>self-contained<br><em>adjective</em></p>
<ul>
<li>(of a thing) complete, or having all that is needed, in itself.</li>
<li>(of a person) quiet and independent; not depending on or influenced by others.</li>
</ul>
</blockquote>
<p>è¿™å‡ å¤©æˆ‘ä»¬ä¹Ÿæœ‰äº†å°†æœ€ç»ˆç¨‹åºself-containåŒ–çš„éœ€æ±‚ã€‚ç»ˆäºå¯ä»¥åˆç†çš„æŠ›å¼ƒMFCå†™çš„Installeräº†ğŸ˜</p>
<h2 id="Self-contained-in-NET"><a href="#Self-contained-in-NET" class="headerlink" title="Self-contained in .NET"></a>Self-contained in .NET</h2><p>.NETåœ¨è®¾è®¡ä¹‹åˆåªæ˜¯æƒ³æé«˜Windowsç¨‹åºå‘˜çš„å¼€å‘æ•ˆç‡ï¼Œé¡ºä¾¿è§£å†³ä¸€ä¸‹<a href="https://en.wikipedia.org/wiki/DLL_Hell" target="_blank" rel="external">DLL Hell</a>ã€‚è‡³äºåº”ç”¨åˆ†å‘æ ¹æœ¬å°±ä¸å†æ—¥ç¨‹ä¸Šã€‚å°±ç®—çœŸçš„è€ƒè™‘è¿‡ï¼Œä¹Ÿä¸€å®šä¼šé‡‡ç”¨åŠ¨æ€é“¾æ¥çš„æ–¹å¼ã€‚å› ä¸º<a href="https://en.wikipedia.org/wiki/.NET_Framework_version_history" target="_blank" rel="external">å½“æ—¶</a>çš„ç¡¬ç›˜è¿˜æ˜¯å¾ˆè´µæ»´ã€‚</p>
<p>æ€»ä¹‹ï¼Œ.NETå°±è¿™æ ·å†³å®šé‡‡ç”¨åŠ¨æ€é“¾æ¥äº†ã€‚.NETé‡Œçš„å‡ ä¸ªåŸºæœ¬æ¦‚å¿µä¹Ÿéƒ½ä¸åŠ¨æ€é“¾æ¥è„±ä¸å¼€å…³ç³»ï¼š</p>
<p><a href="https://en.wikipedia.org/wiki/Assembly_(CLI" target="_blank" rel="external">ç¨‹åºé›†</a>)æ˜¯.NETä¸–ç•Œé‡Œæœ€å¸¸è§çš„åˆ†å‘å•å…ƒã€‚ç¨‹åºé›†æœ‰ç‹¬ç«‹çš„ç‰ˆæœ¬å·ã€‚åœ¨å¼•ç”¨å…¶ä»–ç¨‹åºé›†çš„æ—¶å€™ï¼Œéœ€è¦æ˜¾å¼æŒ‡æ˜å¯¹åº”çš„ç‰ˆæœ¬ã€‚è¿™æ ·ï¼Œç›¸åŒåå­—ä¸åŒç‰ˆæœ¬çš„ç¨‹åºé›†å°±å¯ä»¥è¢«åŒºåˆ«å¼€ï¼Œä»¥æ­¤ä¸ºåŸºç¡€å°±è§£å†³Dll hellçš„é—®é¢˜ã€‚CLRåœ¨è¿è¡Œçš„æ—¶å€™ä»¥ä¸€å¥—<a href="https://docs.microsoft.com/en-us/dotnet/framework/deployment/how-the-runtime-locates-assemblies" target="_blank" rel="external">å¤æ‚çš„è§„åˆ™</a>è¯•å›¾åŠ è½½ç¨‹åºçš„ä¾èµ–é¡¹ã€‚</p>
<p>çœ‹èµ·æ¥ä¼¼ä¹.NETä¸é™æ€é“¾æ¥æ— ç¼˜äº†ã€‚ä¸è¿‡ä¹Ÿæœ‰å¥½æ¶ˆæ¯ï¼Œåœ¨Build 2018å¼€å‘è€…å¤§ä¼šä¸Šï¼Œå¾®è½¯<a href="https://blogs.msdn.microsoft.com/dotnet/2018/05/07/net-core-3-and-support-for-windows-desktop-applications/" target="_blank" rel="external">å®£å¸ƒ</a>ç°æœ‰çš„æ¡Œé¢ç¨‹åºå¯ä»¥åœ¨æ˜å¹´æ¨å‡ºçš„.Net core 3ä¸Šé€‰æ‹©ä¸è¿è¡Œæ—¶é™æ€é“¾æ¥åœ¨ä¸€èµ·ï¼Œå°†æ•´ä¸ªç¨‹åºå˜ä¸ºå•ä¸€çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
<blockquote>
<p>Side-by-side and App-local Deployment</p>
<p>For cases where the maximum isolation is required, you can deploy .NET Core with your  application. Weâ€™re working on new build tools that will bundle your app and .NET Core  together as in a single executable, as a new option.</p>
<p><strong>Weâ€™ve had requests for deployment options like this for many years, but were never able to deliver those with the .NET Framework. The much more modular architecture used by .NET Core makes these flexible deployment options possible.</strong></p>
</blockquote>
<p>.Net Core 3.0çš„æ¨å‡ºæ—¶é—´æ˜¯æ˜å¹´ï¼Œæˆ‘ä»¬æ˜¾ç„¶ä¸èƒ½ç­‰åˆ°é‚£ä¸ªæ—¶å€™ã€‚ä¸ºäº†å®ç°éœ€æ±‚ï¼Œå…ˆå‘æœç´¢å¼•æ“æ±‚åŠ©å§ã€‚</p>
<h3 id="é™æ€é“¾æ¥"><a href="#é™æ€é“¾æ¥" class="headerlink" title="é™æ€é“¾æ¥"></a>é™æ€é“¾æ¥</h3><p>é™æ€é“¾æ¥å°†ä¾èµ–é¡¹æ‰“åŒ…è¿›æˆ‘ä»¬çš„ç¨‹åºï¼Œç”Ÿæˆå•ä¸€çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿™æ˜¯ä¸ªå¾ˆç›´è§‚çš„åˆ‡å…¥ç‚¹ã€‚ä»¥<code>C# static link</code>ä¸ºå…³é”®è¯ï¼Œå‘ç°æœ‰å‡ ä¸ªåŒç±»å‹çš„å·¥å…·ã€‚ä¾‹å¦‚<a href="https://github.com/Microsoft/ILMerge" target="_blank" rel="external">ILMerge</a>ã€‚åœ¨.NETçš„ä¸–ç•Œä¸­ï¼Œæºä»£ç ç»è¿‡ç¼–è¯‘åäº§ç”Ÿçš„ç¨‹åºé›†é‡Œå­˜å‚¨çš„å¹¶ä¸æ˜¯æœºå™¨ä»£ç è€Œæ˜¯ä¸€ç§å«<a href="https://en.wikipedia.org/wiki/Common_Intermediate_Language" target="_blank" rel="external">MSIL</a>çš„ä¸­é—´ä»£ç ã€‚ç¨‹åºé›†ç”±CLRåŠ è½½åè¢«JITå³æ—¶ç¼–è¯‘ä¸ºæœºå™¨ç ã€‚</p>
<p>ILMergeä¹‹ç±»çš„å·¥å…·å·¥ä½œåœ¨ILå±‚é¢ã€‚å®ƒä»¬å°†ä¸åŒç¨‹åºé›†çš„ILä»£ç ç²˜åˆèµ·æ¥ï¼Œç”Ÿæˆå•ä¸€çš„ç¨‹åºé›†ã€‚</p>
<p>å¬èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆç¾å¥½ï¼Ÿå¦‚æœä½ å†™ä¸ªå°demoçš„è¯ä¼šå‘ç°ç¡®å®å¾ˆå¥½ç”¨ã€‚ä½†æ˜¯ILMergeæ— æ³•å¯¹WPFä¸­çš„XAMLèµ„æºè¿›è¡Œæ”¹å†™ã€‚ç¨‹åºæŒ‚åœ¨è¿è¡Œæ—¶ã€‚</p>
<h3 id="å†…åµŒèµ„æº"><a href="#å†…åµŒèµ„æº" class="headerlink" title="å†…åµŒèµ„æº"></a>å†…åµŒèµ„æº</h3><p>.NETä¸­çš„ç¨‹åºé›†æœ‰èµ„æºçš„æ¦‚å¿µã€‚ä»»ä½•æ–‡ä»¶éƒ½èƒ½ä»¥èµ„æºçš„å½¢å¼åµŒå…¥è¿›ç¨‹åºé›†ã€‚å¦ä¸€ä¸ªæ€è·¯æ˜¯æ˜¯æŠŠä¾èµ–é¡¹å½“ä½œèµ„æºåµŒè¿›æˆ‘ä»¬çš„ä¸»ç¨‹åºã€‚åªè¦èƒ½åœ¨è¿è¡Œæ—¶æŠŠå®ƒä»¬æš´éœ²ç»™CLRï¼Œå°±èƒ½å®ç°self-containã€‚<br>å…ˆæ¥çœ‹çœ‹APIï¼š</p>
<ul>
<li><code>Assembly.GetManifestResourceStream(string name)</code>:</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Loads the specified manifest resource from this assembly.</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">virtual</span> System.IO.<span class="function">Stream <span class="title">GetManifestResourceStream</span> (<span class="params">Type type, <span class="keyword">string</span> name</span>)</span></div></pre></td></tr></table></figure>
<ul>
<li><code>AppDomain.Load(Byte[])</code>:</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Loads the Assembly with a common object file format (COFF) based image containing an emitted Assembly.</span></div><div class="line"><span class="keyword">public</span> System.Reflection.<span class="function">Assembly <span class="title">Load</span> (<span class="params"><span class="keyword">byte</span>[] rawAssembly</span>)</span>;</div></pre></td></tr></table></figure>
<ul>
<li><code>AppDomain.AssemblyResolve</code></li>
</ul>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Occurs when the resolution of an assembly fails.</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">event</span> ResolveEventHandler AssemblyResolve;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æŠŠä¾èµ–é¡¹åµŒå…¥åˆ°ç¨‹åºå†…éƒ¨åï¼ŒCLRæ‰¾ä¸åˆ°å¼•ç”¨çš„ç¨‹åºé›†çš„æ—¶å€™å°±ä¼šè§¦å‘<code>AppDomain.AssemblyResolve</code>äº‹ä»¶ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œæ‹¿åˆ°ä¾èµ–çš„<code>AssemblyName</code>,<code>Assembly.GetManifestResourceStream(string name)</code>å¾—åˆ°åŒ…å«ä¾èµ–é¡¹çš„çš„<code>stream</code>ï¼ŒæŠŠ<code>stream</code>çš„å†…å®¹è¯»å‡ºæ¥æ”¾åˆ°<code>byte[]</code>é‡Œï¼Œè°ƒç”¨<code>AppDomain.Load(Byte[])</code>å°†ç¨‹åºé›†åŠ è½½ã€‚</p>
<p>å¤§è‡´è¿‡ç¨‹èµ°å¾—é€šï¼Œä¸è¿‡æœ‰ç‚¹éº»çƒ¦ã€‚hardcodeä¾èµ–çš„åå­—åï¼Œä»¥åæ·»åŠ æ–°ä¾èµ–é¡¹è¿˜è¦æ›´æ”¹hardcodeçš„åå­—ã€‚æ¯•ç«Ÿç¨‹åºå‘˜ä¹Ÿæ˜¯äººï¼Œä¹Ÿæƒ³å·æ‡’ã€‚è¿™äº›æ´»æœ€å¥½è‡ªåŠ¨åŒ–ã€‚è¦æ˜¯èƒ½å’ŒVSé‡Œçš„ç¼–è¯‘ç»“åˆèµ·æ¥å°±æ›´å¥½äº†ğŸ¤¤</p>
<p>ä½ åˆ«è¯´ï¼Œè¿˜çœŸæœ‰è¿™æ ·çš„å·¥å…·ã€‚<a href="https://github.com/Fody/Fody" target="_blank" rel="external">Fody</a>å¯ä»¥å¯¹.NETç¨‹åºé›†åšå¤šç§æ“ä½œã€‚<a href="https://github.com/Fody/Costura/" target="_blank" rel="external">Costura</a>æ˜¯Fodyçš„ä¸€ä¸ªæ‰©å±•ï¼Œä¸“é—¨ç”¨æ¥å°†ä¾èµ–åµŒå…¥æˆèµ„æºã€‚Fodyä¸VSçš„å®Œç¾é›†æˆï¼Œç¼–è¯‘å®Œæˆåè‡ªåŠ¨å¼€å§‹æ“ä½œã€‚<br>Nugetå®‰è£…å®ŒFodyå’ŒCosturaåï¼Œå¦‚æœè§£å†³æ–¹æ¡ˆæ ¹è·¯å¾„ä¸‹æ²¡æœ‰<code>FodyWeavers.xml</code>åˆ™æ–°å»ºå®ƒã€‚æŠŠå†…å®¹æ›¿æ¢ä¸º</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">Weavers</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">Costura</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">Weavers</span>&gt;</span>`</div></pre></td></tr></table></figure>
<p>å°±å®Œäº‹äº†ã€‚å¤ªæ˜“ç”¨äº†ã€‚æˆ‘åšäº†æµ‹è¯•ï¼ŒWPFå’Œæ§åˆ¶å°åº”ç”¨éƒ½å¯ä»¥ã€‚çœ‹æ–‡æ¡£ï¼Œå®ƒè¿˜æ”¯æŒ.NET Coreã€‚</p>
<h2 id="Dependencies-of-my-dependencies-is-not-my-dependencies"><a href="#Dependencies-of-my-dependencies-is-not-my-dependencies" class="headerlink" title="Dependencies of my dependencies, is not my dependencies"></a>Dependencies of my dependencies, is not my dependencies</h2><p>ILMergeä¹Ÿå¥½ï¼ŒFodyä¹Ÿå¥½ï¼Œå®ƒä»¬è§£å†³çš„éƒ½æ˜¯åº”ç”¨ç¨‹åºæ‰€ä¾èµ–åº“çš„é—®é¢˜ã€‚è€Œæˆ‘ä»¬çš„ç¨‹åºä¹‹æ‰€ä»¥å«.NETç¨‹åºï¼Œæ˜¯å› ä¸ºå®ƒä¾èµ–.NET Frameworkã€‚å¦‚æœè¦åšåˆ°fully-self-containedçš„è¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŠŠ.NET Frameworkä¹Ÿå¡è¿›å»ã€‚è¿™å°±æ„å‘³è¿™æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸ä¾èµ–.NET Frameworkçš„ç¨‹åºæ¥é‡Šæ”¾.NET Frameworkå’Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚è¿™å…¶å®å°±æ˜¯é‡æ–°å‘æ˜å®‰è£…ç¨‹åºäº†ã€‚é€€ä¸€æ­¥è¯´ï¼Œå°±ç®—æˆ‘ä»¬çœŸçš„æŠŠ.NET Frameworkæ‰“åŒ…è¿›å»äº†ï¼Œå› ä¸º.NET Frameworkçš„å®‰è£…è¿‡ç¨‹æ¯”è¾ƒè€—æ—¶ï¼Œç”¨æˆ·åœ¨ç‚¹äº†æŒ‰é’®åå‡ ç§’é’Ÿå¦‚æœUIè¿˜æ²¡å‡ºæ¥å¯èƒ½ä¼šè®¤ä¸ºæˆ‘ä»¬çš„ç¨‹åºæœ‰é—®é¢˜ã€‚å› æ­¤ï¼ŒæŠŠç¨‹åºå’Œ.NET Frameworkä¸€èµ·åˆ†å‘çš„äº‹æƒ…å°±äº¤ç»™æ„¿æ„æŠ˜è…¾çš„åŒå­¦ä»¬äº†ã€‚æˆ‘è¿˜æ˜¯æœŸå¾…ä¸‹.NET Core 3.0å§ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¦‚æœä½ çš„ç¨‹åºæ˜¯WPFç¨‹åºï¼Œè¯·ä½¿ç”¨Fody.Costuraï¼›</p>
<p>å¦‚æœä½ çš„ç¨‹åºä¸æ˜¯WPFç¨‹åºï¼Œé‚£ä¹ˆå¯ä»¥ä»»é€‰ILMergeå’ŒFody.Costuraçš„ä¸€ä¸ªã€‚</p>
<p>å¦‚æœä½ çš„ç¨‹åºéœ€è¦ä¸.NET Frameworkä¸€èµ·åˆ†å‘ï¼Œè¯·åœ¨å¤„ç†ä¸»ç¨‹åºåä½¿ç”¨æ”¯æŒé™é»˜å®‰è£…çš„Installerå°†ä¸»ç¨‹åºä¸.NETè¿è¡Œæ—¶ä¸€èµ·æ‰“åŒ…ã€‚</p>
<p><del>æˆ–è€…ç­‰.Net Core 3.0å‘å¸ƒ</del></p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><p><a href="https://blogs.msdn.microsoft.com/dotnet/2018/05/07/net-core-3-and-support-for-windows-desktop-applications/" target="_blank" rel="external">.Net Core 3.0 - blogs.msdn.microsoft.com</a></p>
</li>
<li><p><a href="https://docs.microsoft.com/en-us/dotnet/framework/deployment/how-the-runtime-locates-assemblies" target="_blank" rel="external">How the Runtime Locates Assemblies - docs.microsoft.com</a></p>
</li>
<li><p><a href="https://github.com/Fody/Fody" target="_blank" rel="external">Fody - github.com</a></p>
</li>
<li><p><a href="https://github.com/Fody/Costura/" target="_blank" rel="external">Costura - github.com</a></p>
</li>
<li><p><a href="https://docs.microsoft.com/en-us/dotnet/framework/deployment/deployment-guide-for-developers#chaining" target="_blank" rel="external">.NET Framework deployment guide for developers - docs.microsoft.com</a></p>
</li>
</ul>

  	</div>
	  
	  <div class="article-tags tags">
      
        <a href="/tags/WPF/">WPF</a>
      
        <a href="/tags/Net-Framework/">.Net Framework</a>
      
	  </div>
    
		
	
		<div class="art-item-footer">
				
					<span class="art-item-left"><i class="icon icon-chevron-thin-left"></i>prevï¼š<a href="/2018/08/30/build-script-with-msbuild/" rel="prev"  title="ä½¿ç”¨MSBuildç¼–å†™æ„å»ºè„šæœ¬">
						ä½¿ç”¨MSBuildç¼–å†™æ„å»ºè„šæœ¬ 
					</a></span>
				
				
					<span class="art-item-right">nextï¼š<a href="/2018/07/19/overhead-of-reference-types/" rel="next"  title="å¼•ç”¨ç±»å‹çš„å¼€é”€">
						å¼•ç”¨ç±»å‹çš„å¼€é”€
					</a><i class="icon icon-chevron-thin-right"></i></span>
				
		</div>
	
	</section>
	
</article>
<script>
	window.subData = {
		title: 'Build a (partial) self-contained WPF application',
		tools: true
	}
</script>

      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>

<img class='avatar waves-image' src='/rei.png' />

<div class='header'>Verrickt</div>
<div class='content'>
<div class='desc'>What one programmer can do in one month, two programmers can do in two months</div>
</div>
</section>

  <section class='m_widget links'>
<div class='header'>My friends</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="https://sjx1995.github.io">
            <div class='name'>Sunly</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://liun1an.github.io">
            <div class='name'>LiuN1an</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://woodencross.github.io">
            <div class='name'>Woodencross</div>
        </a></li>
    
    </ul>
</div>
</section>

  <section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'>
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/FluentTreeView/"><div class='name'>FluentTreeView</div><div class='badget'>5</div></a></li>
    
        <li><a class="flat-box" href="/categories/Machine-learning/"><div class='name'>Machine learning</div><div class='badget'>12</div></a></li>
    
        <li><a class="flat-box" href="/categories/Other/"><div class='name'>Other</div><div class='badget'>2</div></a></li>
    
    </ul>
    
</div>
</section>

  
<div class="m_widget tagcloud">
    <div class="header">Tags</div>
    <div class='content'>
        <a href="/tags/Net-Framework/" style="font-size: 14px; color: #808080">.Net Framework</a> <a href="/tags/Anaconda/" style="font-size: 15.2px; color: #666">Anaconda</a> <a href="/tags/BSOD/" style="font-size: 14px; color: #808080">BSOD</a> <a href="/tags/Backpropagation/" style="font-size: 14px; color: #808080">Backpropagation</a> <a href="/tags/C/" style="font-size: 17.6px; color: #333">C#</a> <a href="/tags/CNN/" style="font-size: 14px; color: #808080">CNN</a> <a href="/tags/CPP/" style="font-size: 14px; color: #808080">CPP</a> <a href="/tags/CUDA/" style="font-size: 14px; color: #808080">CUDA</a> <a href="/tags/Debugging/" style="font-size: 14px; color: #808080">Debugging</a> <a href="/tags/Github-Actions/" style="font-size: 14px; color: #808080">Github Actions</a> <a href="/tags/HTML/" style="font-size: 14px; color: #808080">HTML</a> <a href="/tags/HttpClient/" style="font-size: 14px; color: #808080">HttpClient</a> <a href="/tags/Information-theory/" style="font-size: 14px; color: #808080">Information theory</a> <a href="/tags/Jupyter/" style="font-size: 14px; color: #808080">Jupyter</a> <a href="/tags/Linear-algebra/" style="font-size: 14px; color: #808080">Linear algebra</a> <a href="/tags/MSBuild/" style="font-size: 14px; color: #808080">MSBuild</a> <a href="/tags/Machine-learning/" style="font-size: 20px; color: #000">Machine learning</a> <a href="/tags/Numberical-computation/" style="font-size: 14px; color: #808080">Numberical computation</a> <a href="/tags/OOP/" style="font-size: 14px; color: #808080">OOP</a> <a href="/tags/PAT/" style="font-size: 18.8px; color: #1a1a1a">PAT</a> <a href="/tags/PCA/" style="font-size: 14px; color: #808080">PCA</a> <a href="/tags/Parser/" style="font-size: 14px; color: #808080">Parser</a> <a href="/tags/Powershell/" style="font-size: 14px; color: #808080">Powershell</a> <a href="/tags/Probability/" style="font-size: 14px; color: #808080">Probability</a> <a href="/tags/RNN/" style="font-size: 14px; color: #808080">RNN</a> <a href="/tags/Reentrance/" style="font-size: 14px; color: #808080">Reentrance</a> <a href="/tags/Regularization/" style="font-size: 14px; color: #808080">Regularization</a> <a href="/tags/SOLID/" style="font-size: 14px; color: #808080">SOLID</a> <a href="/tags/SVM/" style="font-size: 14px; color: #808080">SVM</a> <a href="/tags/Semi-supervised-learning/" style="font-size: 14px; color: #808080">Semi-supervised learning</a> <a href="/tags/Tensorflow/" style="font-size: 14px; color: #808080">Tensorflow</a> <a href="/tags/The-flower-book/" style="font-size: 16.4px; color: #4d4d4d">The flower book</a> <a href="/tags/UWP/" style="font-size: 14px; color: #808080">UWP</a> <a href="/tags/VSCode/" style="font-size: 14px; color: #808080">VSCode</a> <a href="/tags/WPF/" style="font-size: 15.2px; color: #666">WPF</a> <a href="/tags/async-await/" style="font-size: 14px; color: #808080">async/await</a> <a href="/tags/classification/" style="font-size: 14px; color: #808080">classification</a> <a href="/tags/lambda/" style="font-size: 14px; color: #808080">lambda</a> <a href="/tags/logistic-regression/" style="font-size: 14px; color: #808080">logistic regression</a> <a href="/tags/neural-network/" style="font-size: 14px; color: #808080">neural network</a> <a href="/tags/overhead/" style="font-size: 14px; color: #808080">overhead</a> <a href="/tags/reference-type/" style="font-size: 14px; color: #808080">reference type</a>
    </div>
</div>



  <section class='m_widget categories'>

    <div class='header'>Statistics</div>
    <div class='content'>
        <ul class="entry">
            <li>
                <a class='flat-box'>
                    <div class='name'>Page Viewer</div>
                    <div class='badget' id='busuanzi_value_site_pv'></div>
                </a>
            </li>
            <li>
                <a class='flat-box'>
                    <div class='name'>Unique Viewer</div>
                    <div class='badget' id='busuanzi_value_site_uv'></div>
                </a>
            </li>
            <li>
                <a class='flat-box'>
                    <div class='name'>Up time</div>
                    <div class='badget'>
                        
                            
                                1614
                                    Days
                    </div>
                </a>
            </li>
            <li>
                <a class='flat-box'>
                    <div class='name'>Last Updated</div>
                    <div class='badget'>
                            Mar 27, 2022
                                    
                    </div>
                </a>
            </li>
            <li>
                <a class='flat-box'>
                    <div class='name'>Blogs</div>
                    <div class='badget'>
                        45
                    </div>
                </a>
            </li>
        </ul>
    </div>

      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/verrickt" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="https://twitter.com/verrickt" class="social twitter"
          target="_blank" rel="external">
          <span class="icon icon-twitter"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  <div class="footer_content">
    Melchior on CLR
    Â©
    2017
      -
    2022,
    brought to life with â¤ï¸ By
    <a  href='/' >
      Verrickt
    </a>

  </div>
  <div class="footer_content">
    Powered by <a href='https://hexo.io/' target="blank_">Hexo</a> |
    Theme based on <a target="blank_" href='https://github.com/stkevintan/hexo-theme-material-flow' class="">MaterialFlow</a></div>
  
</footer>


  <script>setLoadingBarProgress(80);</script>
  

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>
<script src="/js/canvas.js"></script>
<script src="/js/typed.js"></script>

  <script>setLoadingBarProgress(100);</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
